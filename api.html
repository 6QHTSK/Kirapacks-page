<!DOCTYPE html>
<html>

<head>
    <!-- import Vue before Element -->
    <script src="https://cdn.jsdelivr.net/npm/vue@v2.6.11/dist/vue.js"></script>
    <!-- import JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/element-ui@2.13.1/lib/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/http-vue-loader/src/httpVueLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.19.2/dist/axios.min.js"></script>
    <!-- import vue javascript-->
    <meta charset="UTF-8">
    <!-- import CSS -->
    <link href="https://cdn.jsdelivr.net/npm/element-ui@2.13.1/lib/theme-chalk/index.css" rel="stylesheet">
    <title>谱面难度api</title>
</head>

<body>
    <div id="app">
        <div style="display: none;">
            <diffanalysis ref="diffanalysis"></diffanalysis>
        </div>
        <el-container>
            {result:"{{flag}}"",diff:"{{totaldiff}}"}
        </el-container>
    </div>
</body>

</html>
<script>
    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) { return pair[1]; }
        }
        return (false);
    }
    Vue.use(httpVueLoader);
    var vm = new Vue({
        el: '#app',
        data: function () {
            return {
                flag: false,
                totaldiff: ""
            }
        },
        components: {
            'diffanalysis': 'url:.\\components\\diffanalysis\\diffanalysis.vue'
        },
        template: ``,
        mounted() {
            while (this.$refs.diffanalysis == null);
            id = getQueryString("id")
            console.log(id);
            if (id != null) {
                this.$refs.diffanalysis.bestdoriid = id.toString();
                this.$refs.diffanalysis.getbestdorichart();
                func1(vm, 5);
            }

        }
    });
    function func1(vm, i) {
        if (i < 0)
            return null;
        if (vm.$refs.diffanalysis.showdetail) {
            vm.flag = true;
            vm.totaldiff = vm.$refs.diffanalysis.totalstrdiff;
            return true;
        }
        else {
            setTimeout(func1(vm, i - 1), 500);
        }
    }
</script>
<style>
</style>